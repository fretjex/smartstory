<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SUBTLEX-CH Top 50 Quiz — Heatmap</title>
<style>
  :root{
    --bg:#fbfbfb; --fg:#111;
    --green:#63C384; --yellow:#FFD966; --red:#FF7373; --neutral:#eee;
    --cell:64px;
  }
  body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial; margin:20px; background:var(--bg); color:var(--fg);}
  h1{margin:.1rem 0}
  p.lead{margin-top:0;color:#444}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0 18px;align-items:center}
  button,select{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,.08);background:white;cursor:pointer}
  .primary{background:linear-gradient(180deg,#1f9cff,#0b7bd1);color:white;border:none}
  .controls{display:flex;gap:8px;align-items:center}
  .quiz-area{display:flex;gap:18px;flex-wrap:wrap}
  .panel{background:white;padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(12,18,30,.06);flex:1;min-width:280px}
  .char-big{font-size:70px;text-align:center;padding:18px 0}
  .choices{display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
  .choices button{min-width:120px;padding:10px 14px;font-size:16px}
  .grid{display:grid;grid-template-columns:repeat(10,var(--cell));gap:10px;margin-top:12px}
  .cell{width:var(--cell);height:var(--cell);display:flex;align-items:center;justify-content:center;font-size:28px;border-radius:8px;border:1px solid rgba(0,0,0,.06);background:var(--neutral);cursor:default}
  .a{background:var(--green)} .b{background:var(--yellow)} .c{background:var(--red)}
  .meta{font-size:13px;color:#666;margin-top:8px}
  .small{font-size:13px}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .footer{margin-top:18px;color:#666;font-size:13px}
  a.link{color:#0b7bd1}
  @media (max-width:880px){ .grid{grid-template-columns:repeat(5,calc((100% - 40px)/5))} }
</style>
</head>
<body>

<h1>SUBTLEX-CH Top 50 — Quiz & Heatmap</h1>
<p class="lead">Quick self-check for the 50 most frequent Chinese characters (SUBTLEX-CH). Answer each character: <strong>a</strong> = know without hesitation, <strong>b</strong> = know but review, <strong>c</strong> = don't know yet.</p>

<div class="toolbar">
  <div class="controls">
    <label for="order">Order:</label>
    <select id="order">
      <option value="freq">Frequency (fixed)</option>
      <option value="shuffle">Shuffle</option>
    </select>

    <button id="start" class="primary">Start Quiz</button>
    <button id="reset">Reset Answers</button>
  </div>

  <div style="margin-left:auto" class="actions">
    <button id="exportCsv">Export CSV</button>
    <button id="openHeatmap">Open Heatmap</button>
    <button id="generateLink">Generate Share Link</button>
  </div>
</div>

<div class="quiz-area">
  <div class="panel" style="flex-basis:360px">
    <div id="quizIntro">
      <p class="meta">Press the buttons or keys <kbd>A</kbd> / <kbd>B</kbd> / <kbd>C</kbd> to answer. Use <kbd>←</kbd> / <kbd>→</kbd> to go prev/next. Answers are saved locally in your browser until you reset or export.</p>
    </div>

    <div id="quiz" style="display:none">
      <div class="char-big" id="currentChar">的</div>
      <div style="text-align:center" id="counter">1 / 50</div>
      <div class="choices" style="margin-top:10px">
        <button data-val="a" class="a">A — Know (no hesitation)</button>
        <button data-val="b" class="b">B — Review</button>
        <button data-val="c" class="c">C — Don't know</button>
      </div>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
        <button id="prev">◀ Prev</button>
        <button id="next">Next ▶</button>
        <button id="rand">Go to random</button>
      </div>
      <div class="meta" id="currentNote"></div>
    </div>
  </div>

  <div class="panel">
    <h3 style="margin-top:0">Heatmap (live preview)</
